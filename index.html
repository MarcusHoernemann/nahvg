<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover">
<title>NahVG Mitglieder-Infosystem</title>
<link rel="icon" type="image/png" href="logo.png">
<link rel="apple-touch-icon" href="logo.png">
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="NahVG Info">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#003a66">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
:root{--nahvg-blue:#003a66;--nahvg-yellow:#ffcc00;--success-green:#28a745;--alert-red:#d93025;--text-dark:#333;--contact-gray:#eceff1}body{font-family:-apple-system,system-ui,sans-serif;background-color:var(--nahvg-blue);margin:0;padding:0;color:var(--text-dark);min-height:100vh}header{background-color:var(--nahvg-blue);color:#fff;padding:45px 15px 25px 15px;text-align:center;border-bottom:4px solid var(--nahvg-yellow);position:relative}.info-trigger{position:absolute;top:45px;right:20px;background:var(--alert-red);color:#fff;width:25px;height:25px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.85rem;font-weight:700;cursor:pointer;box-shadow:0 0 8px rgba(0,0,0,.3);border:2px solid #fff;z-index:10}header h1{margin:0;font-size:1.8rem;letter-spacing:1px}header h2{margin:5px 0 0 0;font-size:1.1rem;color:var(--nahvg-yellow);font-weight:400;min-height:1.3em}.container{padding:15px;max-width:1200px;margin:auto}.app-card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.3);max-width:600px;margin:0 auto 15px auto}input,select{width:100%;padding:14px;margin:8px 0;border:1px solid #ccc;border-radius:8px;font-size:16px;box-sizing:border-box;background-color:#fff}.stats-bar{background-color:var(--nahvg-yellow);color:var(--nahvg-blue);padding:12px;border-radius:8px;margin:10px 0;font-weight:700;text-align:center;font-size:1rem;border:2px solid var(--nahvg-blue);display:flex;align-items:center;justify-content:center;gap:10px}.btn-email-all{background-color:var(--success-green);color:#fff;padding:16px;border:none;border-radius:8px;font-weight:700;width:100%;cursor:pointer;display:none;margin-bottom:10px;font-size:1rem}#results{display:flex;flex-wrap:wrap;gap:15px;justify-content:center;margin-top:20px}.member-card{background:#fff;border-radius:12px;border-left:6px solid var(--nahvg-blue);box-shadow:0 4px 12px rgba(0,0,0,.15);box-sizing:border-box;width:100%;display:flex;flex-direction:column;overflow:hidden}@media (min-width:900px){.member-card{width:calc(33.333% - 10px)}}@media (min-width:600px) and (max-width:899px){.member-card{width:calc(50% - 8px)}}.m-body{padding:18px;flex-grow:1}.m-title{font-weight:700;color:var(--nahvg-blue);font-size:1.2rem;margin-bottom:5px}.m-info{font-size:.95rem;margin-top:4px;color:#444;line-height:1.3}.address-sub{margin-left:24px;display:block}.badge-container{margin-top:12px;display:flex;gap:10px}.badge{background:#cfd8dc;padding:4px 8px;border-radius:4px;font-size:.75rem;color:var(--nahvg-blue);font-weight:700}.contact-links{background-color:var(--contact-gray);padding:14px 18px;border-top:1.5px solid #d1d9e0;display:flex;justify-content:space-around}.contact-links a,.contact-links span{color:var(--nahvg-blue);font-weight:700;text-decoration:none;font-size:.95rem;cursor:pointer}#fileInput,#setupScreen,#appArea{display:none}#toast{visibility:hidden;background:var(--success-green);color:#fff;text-align:center;padding:16px 30px;position:fixed;bottom:50px;left:50%;transform:translateX(-50%);border-radius:50px;z-index:2000;font-weight:700;box-shadow:0 10px 30px rgba(0,0,0,.5);border:2px solid #fff;min-width:200px}#toast.show{visibility:visible}.modal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:25px;border-radius:12px;width:90%;max-width:550px;box-shadow:0 0 100px rgba(0,0,0,.5);z-index:1000;max-height:85vh;overflow-y:auto}.info-list{margin:0 0 15px 0;padding:0 0 0 20px;font-size:.9rem;line-height:1.4;color:#333}.info-list li{margin-bottom:10px}.legal-box{background:#f4f7f9;padding:15px;border-radius:8px;border-left:5px solid var(--nahvg-blue);font-size:.85rem;margin-top:10px;color:#2c3e50}
</style>
</head>
<body>
<header>
<div class="info-trigger" onclick="_tM('infoModal')">i</div>
<h1>NahVG</h1>
<h2 id="ogNameDisplay">System l√§dt...</h2>
<div>Mitglieder-Infosystem</div>
</header>
<div class="container">
<div id="setupScreen" class="app-card" style="display:block">
<h3 style="text-align:center;color:var(--nahvg-blue)">Version 1.2.9</h3>
<p id="statusMsg" style="text-align:center;color:#666">Bereit f√ºr Import.</p>
<label for="fileInput" id="uploadBtn" style="background:var(--nahvg-yellow);color:var(--nahvg-blue);padding:18px;display:block;text-align:center;border-radius:10px;font-weight:700;cursor:pointer">üìÇ DATEI LADEN</label>
<input type="file" id="fileInput" accept=".xlsx, .xls">
</div>
<div id="appArea">
<div class="app-card">
<input type="text" id="searchInput" placeholder="Suchen (Name, Ort, T√§tigkeit...)" onkeyup="_fD()">
<select id="filterArbeitgeber" onchange="_fD()">
<option value="">Alle Betriebe</option>
</select>
<div id="statsDisplay" class="stats-bar">
<span>üë•</span> <span id="statsText">Berechne...</span>
</div>
<button id="emailAllBtn" class="btn-email-all" onclick="_sBE()">üìß Mail schreiben</button>
<button onclick="_rA()" style="background:0 0;border:none;color:var(--nahvg-blue);text-decoration:underline;font-size:.8rem;width:100%;cursor:pointer;margin-top:15px;opacity:.7">Ortsgruppe wechseln</button>
</div>
<div id="results"></div>
</div>
</div>
<div id="infoModal" class="modal">
<h3>System-Information & Datenschutz</h3>
<ul class="info-list">
<li><b>Funktionsumfang:</b> Volltextsuche, Filterung nach Arbeitgeber, Schnellwahl-Funktion und Erstellung von BCC-E-Mail-Listen f√ºr Gruppenbenachrichtigungen.</li>
<li><b>Lokale Datenhoheit:</b> Diese App ist eine reine "Client-Side"-Anwendung. Alle von Ihnen geladenen Excel-Daten verbleiben physisch auf Ihrem Endger√§t.</li>
<li><b>Kein Datentransfer:</b> Es findet keine √úbertragung der Mitgliederdaten an externe Server statt.</li>
<li><b>Speicherung:</b> Die Daten werden im LocalStorage abgelegt.</li>
</ul>
<div class="legal-box">
<b>Datenschutz-Garantie:</b><br>
Die technische Architektur stellt sicher, dass die Kontrolle beim autorisierten Nutzer liegt.
</div>
<p style="margin-top:20px;font-size:.85rem;color:#666;line-height:1.5;border-top:1px solid #eee;padding-top:10px">
Entwicklung: Marcus H√∂rnemann<br>
Version 1.2.9
</p>
<button onclick="_tM('infoModal')" style="width:100%;padding:14px;background:var(--nahvg-blue);color:#fff;border-radius:8px;border:none;font-weight:700;cursor:pointer">Schlie√üen</button>
</div>
<div id="toast">‚úÖ Kopiert!</div>
<script>
let _m=[],_cfe=[];window.onload=function(){const a=localStorage.getItem('gewerkschafts_daten'),b=localStorage.getItem('gewerkschafts_og_name');if(a&&a!=="[]"){try{_m=JSON.parse(a);document.getElementById('ogNameDisplay').innerText=b||"NahVG Info";_sA()}catch(e){}}document.getElementById('fileInput').addEventListener('change',_pF,false)};function _pF(a){const b=a.target.files[0];if(!b)return;let c=b.name.replace(/\.[^/.]+$/,"").replace(/_/g," ");const d=new FileReader();d.onload=function(e){try{const f=new Uint8Array(e.target.result),g=XLSX.read(f,{type:'array'}),h=g.Sheets[g.SheetNames[0]],i=XLSX.utils.sheet_to_json(h,{raw:false});_m=i.filter(m=>(m.Nachname||m['Nachname'])&&String(m.Nachname||m['Nachname']).trim()!=="");_m.sort((x,y)=>String(x.Nachname||"").localeCompare(String(y.Nachname||"")));localStorage.setItem('gewerkschafts_daten',JSON.stringify(_m));localStorage.setItem('gewerkschafts_og_name',c);document.getElementById('ogNameDisplay').innerText=c;_sA()}catch(err){alert("Datei-Fehler.")}};d.readAsArrayBuffer(b)}function _sA(){document.getElementById('setupScreen').style.display='none';document.getElementById('appArea').style.display='block';_sF();_fD()}function _sF(){const a=document.getElementById('filterArbeitgeber'),b=[...new Set(_m.map(m=>m['Arbeitgeber:']||m['Arbeitgeber']).filter(x=>x))].sort();a.innerHTML='<option value="">Alle Betriebe</option>';b.forEach(x=>{const o=document.createElement('option');o.value=x;o.innerText=x;a.appendChild(o)})}function _fD(){const a=document.getElementById('searchInput').value.toLowerCase(),b=document.getElementById('filterArbeitgeber').value,c=document.getElementById('results'),d=document.getElementById('statsText'),e=document.getElementById('emailAllBtn');c.innerHTML="";const f=_m.filter(m=>{const s=Object.values(m).join(' ').toLowerCase(),ma=s.includes(a),ca=m['Arbeitgeber:']||m['Arbeitgeber']||'';return ma&&(b===""||ca===b)});_cfe=f.map(m=>m['E-Mail (prim√§r)']||m['E-Mail']||m['Email']).filter(x=>x&&x.includes('@'));d.innerText=`${f.length} Mitglieder`;e.style.display=_cfe.length>0?"block":"none";f.forEach(m=>{const t=m['Mobil']||m['Telefon']||'',tk=m['T√§tigkeit des Mitglieds:']||m['T√§tigkeit']||m['Beruf']||'-',em=m['E-Mail (prim√§r)']||m['E-Mail']||m['Email']||'';c.innerHTML+=`<div class="member-card"><div class="m-body"><div class="m-title">${m['Vorname']||''} ${m['Nachname']||''}</div><div class="m-info">üè¢ <b>${m['Arbeitgeber:']||m['Arbeitgeber']||'-'}</b></div><div class="m-info">üõ†Ô∏è ${tk}</div><div class="m-info">üè† ${m['Stra√üe']||'-'}<br><span class="address-sub">${m['PLZ']||''} ${m['Ort']||''}</span></div><div class="badge-container"><span class="badge">üéÇ ${m['Geburtsdatum']||'k.A.'}</span> <span class="badge">üìÖ ${m['Eintritt']||''}</span></div></div><div class="contact-links">${t?`<a href="tel:${t}">üìû Anrufen</a>`:'<span>üìû k.A.</span>'}${em?`<span onclick="_hM('${em}')">‚úâÔ∏è Mail</span>`:'<span>‚úâÔ∏è k.A.</span>'}</div></div>`})}function _hM(a){if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){window.location.href=`mailto:${a}`}else{_cTC(a);_sT("‚úÖ E-Mail kopiert!")}}function _sBE(){if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){window.location.href=`mailto:?bcc=${_cfe.join(',')}&subject=NahVG Info`}else{const a=_cfe.join('; ');_cTC(a);_sT(`‚úÖ ${_cfe.length} Adressen kopiert!`,5000)}}function _tM(a){const b=document.getElementById(a);b.style.display=(b.style.display==='block')?'none':'block'}function _sT(a,b=2500){const t=document.getElementById("toast");t.innerText=a;t.className="show";setTimeout(()=>{t.className=""},b)}function _cTC(a){const b=document.createElement("textarea");b.value=a;document.body.appendChild(b);b.select();document.execCommand('copy');document.body.removeChild(b)}function _rA(){if(confirm("Daten l√∂schen?")){localStorage.clear();location.reload()}}
</script>
</body>
</html>
